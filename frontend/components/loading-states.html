<!-- Reusable Loading State Components for FoodVisionAI -->

<!-- Circular Progress Indicator -->
<template x-data="circularProgress()" x-ref="circularProgress">
    <div class="relative inline-flex items-center justify-center">
        <svg 
            :width="size" 
            :height="size" 
            :viewBox="viewBox"
            class="transform -rotate-90"
        >
            <!-- Background circle -->
            <circle
                :cx="size / 2"
                :cy="size / 2"
                :r="size / 2 - strokeWidth"
                :stroke-width="strokeWidth"
                fill="none"
                class="stroke-gray-200"
            />
            <!-- Progress circle -->
            <circle
                :cx="size / 2"
                :cy="size / 2"
                :r="size / 2 - strokeWidth"
                :stroke-width="strokeWidth"
                fill="none"
                :stroke-dasharray="strokeDasharray"
                :stroke-dashoffset="strokeDashoffset"
                class="stroke-blue-600 transition-all duration-300 ease-in-out"
                stroke-linecap="round"
            />
        </svg>
        <!-- Progress text -->
        <div class="absolute inset-0 flex items-center justify-center">
            <span class="text-xs font-medium text-gray-700" x-text="`${Math.round(progress)}%`"></span>
        </div>
    </div>
</template>

<!-- Linear Progress Bar -->
<template x-data="linearProgress()" x-ref="linearProgress">
    <div class="w-full bg-gray-200 rounded-full h-2">
        <div 
            :class="colorClasses"
            class="h-2 rounded-full transition-all duration-500 ease-in-out"
            :style="progressStyle"
        ></div>
    </div>
</template>

<!-- Step Progress Indicator -->
<template x-data="stepProgress()" x-ref="stepProgress">
    <div class="flex items-center justify-between w-full">
        <template x-for="(step, index) in steps" :key="index">
            <div class="flex items-center">
                <!-- Step circle -->
                <div :class="getStepClasses(index, step.status)">
                    <template x-if="step.status === 'completed'">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </template>
                    <template x-if="step.status === 'processing'">
                        <div class="w-3 h-3 bg-white rounded-full animate-ping"></div>
                    </template>
                    <template x-if="step.status === 'failed'">
                        <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </template>
                    <template x-if="step.status === 'pending'">
                        <span x-text="index + 1"></span>
                    </template>
                </div>
                
                <!-- Step label -->
                <div class="ml-3 text-sm font-medium text-gray-700" x-text="step.name"></div>
                
                <!-- Connector line -->
                <template x-if="index < steps.length - 1">
                    <div class="flex-1 h-0.5 mx-4 transition-colors duration-300" :class="getConnectorClasses(index)"></div>
                </template>
            </div>
        </template>
    </div>
</template>

<!-- Loading Spinner -->
<template x-data="loadingSpinner()" x-ref="loadingSpinner">
    <div class="flex items-center justify-center">
        <svg 
            :class="[sizeClasses, colorClasses]"
            class="animate-spin"
            fill="none" 
            viewBox="0 0 24 24"
        >
            <circle 
                class="opacity-25" 
                cx="12" 
                cy="12" 
                r="10" 
                stroke="currentColor" 
                stroke-width="4"
            ></circle>
            <path 
                class="opacity-75" 
                fill="currentColor" 
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
            ></path>
        </svg>
    </div>
</template>

<!-- Pulse Indicator -->
<template x-data="pulseIndicator()" x-ref="pulseIndicator">
    <div 
        class="w-3 h-3 rounded-full"
        :class="active ? pulseClasses : 'bg-gray-400'"
    ></div>
</template>

<!-- Skeleton Loader -->
<template x-data="skeletonLoader()" x-ref="skeletonLoader">
    <div class="space-y-3">
        <template x-for="line in Array.from({length: lines})" :key="line">
            <div 
                class="h-4 bg-gray-200 rounded"
                :class="animationClasses"
                :style="`width: ${Math.random() * 40 + 60}%`"
            ></div>
        </template>
    </div>
</template>

<!-- Analysis Stage Loader -->
<template x-data="{
    stages: [
        { name: 'Vision Analysis', icon: 'eye', status: 'processing' },
        { name: 'Nutrition Analysis', icon: 'chart', status: 'pending' },
        { name: 'Cuisine Classification', icon: 'globe', status: 'pending' }
    ],
    currentStage: 0
}" x-ref="analysisLoader">
    <div class="space-y-4">
        <template x-for="(stage, index) in stages" :key="index">
            <div class="flex items-center space-x-4 p-4 rounded-lg" 
                 :class="{
                     'bg-blue-50 border border-blue-200': stage.status === 'processing',
                     'bg-green-50 border border-green-200': stage.status === 'completed',
                     'bg-gray-50 border border-gray-200': stage.status === 'pending',
                     'bg-red-50 border border-red-200': stage.status === 'failed'
                 }">
                <!-- Icon -->
                <div class="flex-shrink-0">
                    <template x-if="stage.icon === 'eye'">
                        <svg class="w-6 h-6" :class="{
                            'text-blue-600 animate-pulse': stage.status === 'processing',
                            'text-green-600': stage.status === 'completed',
                            'text-gray-400': stage.status === 'pending',
                            'text-red-600': stage.status === 'failed'
                        }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                        </svg>
                    </template>
                    <template x-if="stage.icon === 'chart'">
                        <svg class="w-6 h-6" :class="{
                            'text-blue-600 animate-pulse': stage.status === 'processing',
                            'text-green-600': stage.status === 'completed',
                            'text-gray-400': stage.status === 'pending',
                            'text-red-600': stage.status === 'failed'
                        }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                        </svg>
                    </template>
                    <template x-if="stage.icon === 'globe'">
                        <svg class="w-6 h-6" :class="{
                            'text-blue-600 animate-pulse': stage.status === 'processing',
                            'text-green-600': stage.status === 'completed',
                            'text-gray-400': stage.status === 'pending',
                            'text-red-600': stage.status === 'failed'
                        }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </template>
                </div>
                
                <!-- Stage info -->
                <div class="flex-1">
                    <h4 class="font-medium" :class="{
                        'text-blue-800': stage.status === 'processing',
                        'text-green-800': stage.status === 'completed',
                        'text-gray-600': stage.status === 'pending',
                        'text-red-800': stage.status === 'failed'
                    }" x-text="stage.name"></h4>
                    <p class="text-sm" :class="{
                        'text-blue-600': stage.status === 'processing',
                        'text-green-600': stage.status === 'completed',
                        'text-gray-500': stage.status === 'pending',
                        'text-red-600': stage.status === 'failed'
                    }">
                        <template x-if="stage.status === 'processing'">
                            <span>Analyzing...</span>
                        </template>
                        <template x-if="stage.status === 'completed'">
                            <span>Completed</span>
                        </template>
                        <template x-if="stage.status === 'pending'">
                            <span>Waiting...</span>
                        </template>
                        <template x-if="stage.status === 'failed'">
                            <span>Failed</span>
                        </template>
                    </p>
                </div>
                
                <!-- Status indicator -->
                <div class="flex-shrink-0">
                    <template x-if="stage.status === 'processing'">
                        <div class="w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin"></div>
                    </template>
                    <template x-if="stage.status === 'completed'">
                        <svg class="w-5 h-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                    </template>
                    <template x-if="stage.status === 'failed'">
                        <svg class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                        </svg>
                    </template>
                </div>
            </div>
        </template>
    </div>
</template>

<!-- Error State Component -->
<template x-data="{
    error: '',
    retryable: true,
    onRetry: null
}" x-ref="errorState">
    <div class="bg-red-50 border border-red-200 rounded-lg p-6 text-center">
        <svg class="w-12 h-12 text-red-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
        </svg>
        <h3 class="text-lg font-semibold text-red-800 mb-2">Analysis Failed</h3>
        <p class="text-red-700 mb-4" x-text="error || 'An unexpected error occurred during analysis'"></p>
        <template x-if="retryable && onRetry">
            <button 
                @click="onRetry()"
                class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
            >
                Try Again
            </button>
        </template>
    </div>
</template>